---

# CLI/util_base

- name: create a util directory
  file: 
    path: /home/{{gen_user}}/util 
    state: directory 
    group: "{{gen_user}}" 
    owner: "{{gen_user}}"

- name: install base_util for {{gen_user}}
  become_user: "{{gen_user}}"
  git:
    repo:   https://github.com/andyl/base_util.git
    dest:   /home/{{gen_user}}/util/base_util
    depth:  1
    update: yes

- name: run init script 
  become_user: "{{gen_user}}"
  shell: /home/{{gen_user}}/util/base_util/init 
  args:
    creates: /home/{{gen_user}}/.hushlogin

- name: add 'source' directive to ~/.bashrc
  become_user: "{{gen_user}}"
  blockinfile:
    create: yes
    path: /home/{{gen_user}}/.bashrc
    block: |
      [ -f ~/.bashrc_base ]                && source ~/.bashrc_base
      [ -f ~/.asdf/asdf.sh ]               && source ~/.asdf/asdf.sh
      [ -f ~/.asdf/completions/asdf.bash ] && source ~/.asdf/completions/asdf.bash
