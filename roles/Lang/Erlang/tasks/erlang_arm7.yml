---

# erlang arm7

# FOR ARM7 (32 bit RPi/Raspbian and Odroid-XU4)
# - compile script at 'files/arm7/build.sh'
# - precompile erlang directory on an arm7 device
# - save the precompile in x-ansible/roles/erlang/files/arm7/<release>

- name: copy release tarfile
  copy:
    src:  arm7/erl_arm7_{{erlang_arm7_version}}.tar.gz
    dest: /home/{{sys_user}}/.pkg/erl_arm7_{{erlang_arm7_version}}.tar.gz

- name:  expand release tarfile
  shell: tar xf erl_arm7_{{erlang_arm7_version}}.tar.gz
  args:
    chdir:   /home/{{sys_user}}/.pkg
    creates: /home/{{sys_user}}/.pkg/erl_arm7_{{erlang_arm7_version}}

- name:  install arm7 erlang
  become:  yes
  shell: cp -R usr/* /usr
  args:
    chdir:   /home/{{sys_user}}/.pkg/erl_arm7_{{erlang_arm7_version}}
    creates: /usr/local/bin/erl
